<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Filter features of one SE based on their rowData — QFeatures-filtering-oneSE • DaparToolshed</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Filter features of one SE based on their rowData — QFeatures-filtering-oneSE"><meta name="description" content="The filterFeaturesOneSE methods enables users to filter features
based on a variable in their rowData. It is directly inspired of the
function filterFeature of the package QFeatures.
The first difference is that the filter only applies to one
SummarizedExperiment contained in the object rather than applying on
all the SE.
This method generates a new SummarizedExperiment object which is added
to the QFeatures object. If the SE on which the filter applies is the
last one of the object, then a new xxxx. If it is not the last one, the
new SE is added and all the further SE are deleted. The features matching
the. The filters can be provided as instances of class AnnotationFilter
(see the package QFeatures) or of class FunctionFilter (see below)."><meta property="og:description" content="The filterFeaturesOneSE methods enables users to filter features
based on a variable in their rowData. It is directly inspired of the
function filterFeature of the package QFeatures.
The first difference is that the filter only applies to one
SummarizedExperiment contained in the object rather than applying on
all the SE.
This method generates a new SummarizedExperiment object which is added
to the QFeatures object. If the SE on which the filter applies is the
last one of the object, then a new xxxx. If it is not the last one, the
new SE is added and all the further SE are deleted. The features matching
the. The filters can be provided as instances of class AnnotationFilter
(see the package QFeatures) or of class FunctionFilter (see below)."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DaparToolshed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/DaparToolshed.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edyp-lab/DaparToolshed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Filter features of one SE based on their rowData</h1>
      <small class="dont-index">Source: <a href="https://github.com/edyp-lab/DaparToolshed/blob/master/R/DaparToolshed-filterFeaturesOneSE.R" class="external-link"><code>R/DaparToolshed-filterFeaturesOneSE.R</code></a></small>
      <div class="d-none name"><code>QFeatures-filtering-oneSE.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The <code>filterFeaturesOneSE</code> methods enables users to filter features
based on a variable in their <code>rowData</code>. It is directly inspired of the
function <code>filterFeature</code> of the package <code>QFeatures</code>.
The first difference is that the filter only applies to one
<code>SummarizedExperiment</code> contained in the object rather than applying on
all the SE.
This method generates a new <code>SummarizedExperiment</code> object which is added
to the <code>QFeatures</code> object. If the SE on which the filter applies is the
last one of the object, then a new xxxx. If it is not the last one, the
new SE is added and all the further SE are deleted. The features matching
the. The filters can be provided as instances of class <code>AnnotationFilter</code>
(see the package <code>QFeatures</code>) or of class <code>FunctionFilter</code> (see below).</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="va">name</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'QFeatures'</span></span>
<span><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">object</span>, <span class="va">i</span>, name <span class="op">=</span> <span class="st">"newAssay"</span>, <span class="va">filters</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-name">name<a class="anchor" aria-label="anchor" href="#arg-name"></a></dt>
<dd><p>A <code>character(1)</code> naming the new assay. Default is
<code>newAssay</code>. Note that the function will fail if there's
already an assay with <code>name</code>.</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>Additional arguments</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>An instance of class <code>QFeatures</code> or <code>SummarizedExperiment</code>.</p></dd>


<dt id="arg-i">i<a class="anchor" aria-label="anchor" href="#arg-i"></a></dt>
<dd><p>The index or name of the assay which features will be
filtered the create the new assay.</p></dd>


<dt id="arg-filters">filters<a class="anchor" aria-label="anchor" href="#arg-filters"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/list.html" class="external-link">list()</a></code> containing instances of class <code>AnnotationFilter</code>
or <code>FunctionFilter</code></p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A filtered <code>QFeature</code> object</p>
    </div>
    <div class="section level2">
    <h2 id="function-filters">Function filters<a class="anchor" aria-label="anchor" href="#function-filters"></a></h2>



<p>The function filters are filters as defined in the
<a href="DaparToolshed.html">DaparToolshed</a> package. Each filter is defined by a name (which is the
name of a function) and a list which contains the parameters passed to the
function. Those filters can be created with the <code>FunctionFilter</code>
constructor.</p>
<p>Those functions are divided into two main categories:</p><ul><li><p>the one that filter on one rowData feature,</p></li>
<li><p>the one based on a two-dimensional information such as the adjacency
matrix</p></li>
</ul><p>for the first category, all filters of class AnnotationFilter can be
used as they are used in <code>QFeatures</code></p>
<p>For the second category, the package <code>DaparToolshed</code> provides filter
functions based either on the adjacency matrix:</p><ul><li><p></p></li>
<li><p></p></li>
<li><p></p></li>
</ul><p>Or based on the quantitative metadata (identification):</p><ul><li><p></p></li>
<li><p></p></li>
<li><p></p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Samuel Wieczorek</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">feat1</span>, package <span class="op">=</span> <span class="st">'QFeatures'</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Creating function filters</span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">#FunctionFilter('FUN',</span></span></span>
<span class="r-in"><span><span class="co">#               param1 = 'value_of_param1',</span></span></span>
<span class="r-in"><span><span class="co">#               param2 = 'value_of_param2')</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'qMetacellWholeLine'</span>,</span></span>
<span class="r-in"><span>               cmd <span class="op">=</span> <span class="st">'delete'</span>,</span></span>
<span class="r-in"><span>               pattern <span class="op">=</span> <span class="st">'imputed POV'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An object of class "FunctionFilter"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "name":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "qMetacellWholeLine"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Slot "params":</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $cmd</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "delete"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> $pattern</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "imputed POV"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Filter the last assay to keep only specific peptides. This filter</span></span></span>
<span class="r-in"><span><span class="co">## only applies on peptide dataset.</span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">spec.filter</span> <span class="op">&lt;-</span> <span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="co">## using a user-defined character filter</span></span></span>
<span class="r-in"><span><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 set(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Filter the last assay to keep only specific peptides and topn </span></span></span>
<span class="r-in"><span><span class="co">## peptides. The two filters are run sequentially.</span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">lst.filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'specPeptides'</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">lst.filters</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/append.html" class="external-link">append</a></span><span class="op">(</span><span class="va">lst.filters</span>,</span></span>
<span class="r-in"><span><span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'topnPeptides'</span>,</span></span>
<span class="r-in"><span>fun <span class="op">=</span> <span class="st">'rowSums'</span>,</span></span>
<span class="r-in"><span>top <span class="op">=</span> <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="va">lst.filters</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 set(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span><span class="co">## Filter the last assay to delete peptides where, in at least one </span></span></span>
<span class="r-in"><span><span class="co">## condition, there is less than 80% of samples marked as 'imputed POV'</span></span></span>
<span class="r-in"><span><span class="co">## ----------------------------------------------------------------</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">filter</span> <span class="op">&lt;-</span> <span class="fu">FunctionFilter</span><span class="op">(</span><span class="st">'qMetacellOnConditions'</span>,</span></span>
<span class="r-in"><span>cmd <span class="op">=</span> <span class="st">'delete'</span>,</span></span>
<span class="r-in"><span>mode <span class="op">=</span> <span class="st">'AtLeastOneCond'</span>,</span></span>
<span class="r-in"><span>pattern <span class="op">=</span> <span class="st">'imputed POV'</span>,</span></span>
<span class="r-in"><span>conds <span class="op">=</span> <span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">colData</a></span><span class="op">(</span><span class="va">feat1</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span>,</span></span>
<span class="r-in"><span>percent <span class="op">=</span> <span class="cn">TRUE</span>,</span></span>
<span class="r-in"><span>th <span class="op">=</span> <span class="fl">0.8</span>,</span></span>
<span class="r-in"><span>operator <span class="op">=</span> <span class="st">'&lt;'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span> <span class="fu">filterFeaturesOneSE</span><span class="op">(</span><span class="va">feat1</span>, <span class="va">filter</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> An instance of class QFeatures containing 1 set(s):</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] psms: SummarizedExperiment with 10 rows and 2 columns </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

