<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Quantitative metadata vocabulary for entities — q_metacell • DaparToolshed</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quantitative metadata vocabulary for entities — q_metacell"><meta name="description" content="This function gives the vocabulary used for the quantitative metadata of each entity in
each condition.
This function is based on the qMetacell dataframe to look for either missing
values (used to update an initial dataset) or imputed values (used when
post processing protein qMetacell after aggregation)
In the quantitative columns, a missing value is identified by no value rather
than a value equal to 0.
Conversion rules
Quanti			Tag
NA or 0		NA
Update the quantitative metadata information of missing values that were imputed
Gives all the tags of the metadata vocabulary containing the pattern
(parent and all its children).
Agregation rules for the cells quantitative metadata of peptides.
Please refer to the qMetacell.def vocabulary in qMetacell.def()"><meta property="og:description" content="This function gives the vocabulary used for the quantitative metadata of each entity in
each condition.
This function is based on the qMetacell dataframe to look for either missing
values (used to update an initial dataset) or imputed values (used when
post processing protein qMetacell after aggregation)
In the quantitative columns, a missing value is identified by no value rather
than a value equal to 0.
Conversion rules
Quanti			Tag
NA or 0		NA
Update the quantitative metadata information of missing values that were imputed
Gives all the tags of the metadata vocabulary containing the pattern
(parent and all its children).
Agregation rules for the cells quantitative metadata of peptides.
Please refer to the qMetacell.def vocabulary in qMetacell.def()"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DaparToolshed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.9</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/DaparToolshed.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edyp-lab/DaparToolshed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Quantitative metadata vocabulary for entities</h1>
      <small class="dont-index">Source: <a href="https://github.com/edyp-lab/DaparToolshed/blob/master/R/metacell.R" class="external-link"><code>R/metacell.R</code></a></small>
      <div class="d-none name"><code>q_metacell.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function gives the vocabulary used for the quantitative metadata of each entity in
each condition.</p>
<p>This function is based on the qMetacell dataframe to look for either missing
values (used to update an initial dataset) or imputed values (used when
post processing protein qMetacell after aggregation)</p>
<p>In the quantitative columns, a missing value is identified by no value rather
than a value equal to 0.
Conversion rules
Quanti			Tag
NA or 0		NA</p>
<p>Update the quantitative metadata information of missing values that were imputed</p>
<p>Gives all the tags of the metadata vocabulary containing the pattern
(parent and all its children).</p>
<p>Agregation rules for the cells quantitative metadata of peptides.
Please refer to the qMetacell.def vocabulary in <code>qMetacell.def()</code></p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">metacell.def</span><span class="op">(</span><span class="va">level</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">custom_metacell_colors</span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Set_POV_MEC_tags</span><span class="op">(</span><span class="va">obj</span>, <span class="va">conds</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Set_POV_MEC_tags2</span><span class="op">(</span><span class="va">conds</span>, <span class="va">df</span>, <span class="va">level</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">Metacell_generic</span><span class="op">(</span><span class="va">qdata</span>, <span class="va">conds</span>, <span class="va">level</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">UpdateMetacellAfterImputation</span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># S4 method for class 'SummarizedExperiment'</span></span>
<span><span class="fu">UpdateMetacellAfterImputation</span><span class="op">(</span><span class="va">object</span>, <span class="va">from</span>, <span class="va">to</span>, <span class="va">...</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">search.metacell.tags</span><span class="op">(</span><span class="va">pattern</span>, <span class="va">level</span>, depth <span class="op">=</span> <span class="st">"1"</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">metacombine</span><span class="op">(</span><span class="va">met</span>, <span class="va">level</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-level">level<a class="anchor" aria-label="anchor" href="#arg-level"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-obj">obj<a class="anchor" aria-label="anchor" href="#arg-obj"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-conds">conds<a class="anchor" aria-label="anchor" href="#arg-conds"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-df">df<a class="anchor" aria-label="anchor" href="#arg-df"></a></dt>
<dd><p>An object of class <code>SummarizedExperiment</code></p></dd>


<dt id="arg-qdata">qdata<a class="anchor" aria-label="anchor" href="#arg-qdata"></a></dt>
<dd><p>A matrix of quantitative data</p></dd>


<dt id="arg-object">object<a class="anchor" aria-label="anchor" href="#arg-object"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg--">...<a class="anchor" aria-label="anchor" href="#arg--"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-from">from<a class="anchor" aria-label="anchor" href="#arg-from"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-to">to<a class="anchor" aria-label="anchor" href="#arg-to"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-pattern">pattern<a class="anchor" aria-label="anchor" href="#arg-pattern"></a></dt>
<dd><p>The string to search.</p></dd>


<dt id="arg-depth">depth<a class="anchor" aria-label="anchor" href="#arg-depth"></a></dt>
<dd><p>xxx</p></dd>


<dt id="arg-met">met<a class="anchor" aria-label="anchor" href="#arg-met"></a></dt>
<dd><p>xxx</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data.frame containing the different tags and corresponding colors for the level
given in parameter</p>
<p>An instance of class <code>QFeatures</code>.</p>
<p>xxxxx</p>
<p>NA</p>
<p>NA</p>
    </div>
    <div class="section level2">
    <h2 id="glossary">Glossary<a class="anchor" aria-label="anchor" href="#glossary"></a></h2>



<p>Peptide-level vocabulary</p>
<p>|– 'Any'
|    |
|    |– 1.0 'Quantified'
|    |    |
|    |    |– 1.1 "Quant. by direct id" (color 4, white)
|    |    |
|    |    |– 1.2 "Quant. by recovery" (color 3, lightgrey)
|    |
|    |– 2.0 "Missing" (no color)
|    |    |
|    |    |– 2.1 "Missing POV" (color 1)
|    |    |
|    |    |– 2.2 'Missing MEC' (color 2)
|    |
|    |– 3.0 'Imputed'
|    |    |
|    |    |– 3.1 'Imputed POV' (color 1)
|    |    |
|    |    |– 3.2 'Imputed MEC' (color 2)</p>
<p>Protein-level vocabulary:
|– 'Any'
|    |
|    |– 1.0 'Quantified'
|    |    |
|    |    |– 1.1 "Quant. by direct id" (color 4, white)
|    |    |
|    |    |– 1.2 "Quant. by recovery" (color 3, lightgrey)
|    |
|    |– 2.0 "Missing"
|    |    |
|    |    |– 2.1 "Missing POV" (color 1)
|    |    |
|    |    |– 2.2 'Missing MEC' (color 2)
|    |
|    |– 3.0 'Imputed'
|    |    |
|    |    |– 3.1 'Imputed POV' (color 1)
|    |    |
|    |    |– 3.2 'Imputed MEC' (color 2)
|    |
|    |– 4.0 'Combined tags' (color 3bis, lightgrey)</p>
    </div>
    <div class="section level2">
    <h2 id="conversion-to-the-glossary">Conversion to the glossary<a class="anchor" aria-label="anchor" href="#conversion-to-the-glossary"></a></h2>



<p>A generic conversion</p>
<p>Conversion for Proline datasets</p>
<p>Conversion from Maxquant datasets</p>
    </div>
    <div class="section level2">
    <h2 id="basic-agreagtion">Basic agreagtion<a class="anchor" aria-label="anchor" href="#basic-agreagtion"></a></h2>
    <p>Agregation of non imputed values (2.X) with quantitative values</p><table class="table table"><tr><td>(1.0, 1.X, 3.0, 3.X)</td></tr><tr><td>Not possible</td></tr><tr><td>—————————-</td></tr><tr><td></td></tr></table><table class="table table"><tr><td>Agregation of different types of missing values (among 2.1, 2.2)</td></tr><tr><td></td></tr></table><ul><li><p>Agregation of 2.1 peptides between each other gives a missing value
non imputed (2.0)</p></li>
<li><p>Agreagtion of 2.2 peptides between each other givesa missing value
non imputed (2.0)</p></li>
<li><p>Agregation of a mix of 2.1 and 2.2 gives a missing value non imputed (2.0)
|—————————-</p></li>
</ul><table class="table table"><tr><td>Agregation of a mix of quantitative values (among 1.0, 1.1, 1.2, 3.0, 3.X)</td></tr><tr><td></td></tr></table><ul><li><p>if the type of all the peptides to agregate is 1.0, 1.1 or 1.2,
then the final metadata is set the this tag</p></li>
<li><p>if the set of metacell to agregate is a mix of 1.0, 1.1 or 1.2,
then the final metadata is set to 1.0</p></li>
<li><p>if the set of metacell to agregate is a mix of 3.X and 3.0,
then the final metadata is set to 3.0</p></li>
<li><p>if the set of metacell to agregate is a mix of 3.X and 3.0 and other (X.X),
then the final metadata is set to 4.0
|—————————-</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="post-processing">Post processing<a class="anchor" aria-label="anchor" href="#post-processing"></a></h2>
    <p>Update metacell with POV/MEC status for the categories 2.0 and 3.0
TODO</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Burger, Samuel Wieczorek</p>
<p>Samuel Wieczorek</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">metacell.def</span><span class="op">(</span><span class="st">'protein'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   node     parent   color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  Any              white</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           Quantified        Any #0A31D0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Quant. by direct id Quantified #6178D9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Quant. by recovery Quantified #B9C4F2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              Missing        Any #CF8205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          Missing POV    Missing #E5A947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          Missing MEC    Missing #F1CA8A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8              Imputed        Any #A40C0C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          Imputed POV    Imputed #E34343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         Imputed MEC    Imputed #F59898</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 11       Combined tags        Any #1E8E05</span>
<span class="r-in"><span><span class="fu">metacell.def</span><span class="op">(</span><span class="st">'peptide'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>                   node     parent   color</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1                  Any              white</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 2           Quantified        Any #0A31D0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 3  Quant. by direct id Quantified #6178D9</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 4   Quant. by recovery Quantified #B9C4F2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 5              Missing        Any #CF8205</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 6          Missing POV    Missing #E5A947</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 7          Missing MEC    Missing #F1CA8A</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 8              Imputed        Any #A40C0C</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 9          Imputed POV    Imputed #E34343</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 10         Imputed MEC    Imputed #F59898</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">subR25prot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">conds</span> <span class="op">&lt;-</span> <span class="fu"><a href="QFeatures-accessors.html">design.qf</a></span><span class="op">(</span><span class="va">subR25prot</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">Set_POV_MEC_tags</span><span class="op">(</span><span class="va">subR25prot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="va">conds</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://bioconductor.org/packages/SummarizedExperiment" class="external-link">SummarizedExperiment</a></span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">subR25pept</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">conds</span> <span class="op">&lt;-</span> <span class="fu"><a href="QFeatures-accessors.html">design.qf</a></span><span class="op">(</span><span class="va">subR25pept</span><span class="op">)</span><span class="op">$</span><span class="va">Condition</span></span></span>
<span class="r-in"><span><span class="va">qdata</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">assay</a></span><span class="op">(</span><span class="va">subR25pept</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu">Metacell_generic</span><span class="op">(</span><span class="va">qdata</span>, <span class="va">conds</span>, <span class="st">'peptide'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">subR25prot</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">subR25prot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu">UpdateMetacellAfterImputation</span><span class="op">(</span><span class="va">subR25prot</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>, <span class="st">'Missing'</span>, <span class="st">'Imputed'</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="fu">search.metacell.tags</span><span class="op">(</span><span class="st">'Missing POV'</span>, <span class="st">'peptide'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Missing POV"</span>
<span class="r-in"><span><span class="fu">search.metacell.tags</span><span class="op">(</span><span class="st">'Quantified'</span>, <span class="st">'peptide'</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "Quantified"          "Quant. by direct id" "Quant. by recovery" </span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="va">ll</span> <span class="op">&lt;-</span> <span class="fu">omXplore</span><span class="fu">::</span><span class="fu"><a href="https://edyp-lab.github.io/omXplore/reference/q_metadata.html" class="external-link">metacell.def</a></span><span class="op">(</span><span class="st">'peptide'</span><span class="op">)</span><span class="op">$</span><span class="va">node</span></span></span>
<span class="r-in"><span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ll</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html" class="external-link">lapply</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/utils/combn.html" class="external-link">combn</a></span><span class="op">(</span><span class="va">ll</span>, <span class="va">i</span>, simplify <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span>, </span></span>
<span class="r-in"><span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">tag</span> <span class="op">&lt;-</span> <span class="fu">metacombine</span><span class="op">(</span><span class="va">x</span>, <span class="st">'peptide'</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

