<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Aggregation of peptide-level assay QFeatures — RunAggregation • DaparToolshed</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Aggregation of peptide-level assay QFeatures — RunAggregation"><meta name="description" content="This function aggregate both quantitative and rowdata from the last assay contained in a QFeatures.
Note that the function assumes that the intensities in the QFeatures are already log-transformed."><meta property="og:description" content="This function aggregate both quantitative and rowdata from the last assay contained in a QFeatures.
Note that the function assumes that the intensities in the QFeatures are already log-transformed."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DaparToolshed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../articles/DaparToolshed.html">Get started</a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edyp-lab/DaparToolshed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Aggregation of peptide-level assay QFeatures</h1>
      <small class="dont-index">Source: <a href="https://github.com/edyp-lab/DaparToolshed/blob/master/R/aggregation.R" class="external-link"><code>R/aggregation.R</code></a></small>
      <div class="d-none name"><code>RunAggregation.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>This function aggregate both quantitative and rowdata from the last assay contained in a <code>QFeatures</code>.
Note that the function assumes that the intensities in the QFeatures are already log-transformed.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">RunAggregation</span><span class="op">(</span></span>
<span>  <span class="va">qf</span>,</span>
<span>  includeSharedPeptides <span class="op">=</span> <span class="st">"Yes_As_Specific"</span>,</span>
<span>  operator <span class="op">=</span> <span class="st">"Mean"</span>,</span>
<span>  considerPeptides <span class="op">=</span> <span class="st">"allPeptides"</span>,</span>
<span>  adjMatrix <span class="op">=</span> <span class="st">"adjacencyMatrix"</span>,</span>
<span>  ponderation <span class="op">=</span> <span class="st">"Global"</span>,</span>
<span>  n <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  aggregated_col <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">500</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-qf">qf<a class="anchor" aria-label="anchor" href="#arg-qf"></a></dt>
<dd><p>An instance of class <a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">QFeatures</a>. The last assay contained in <code>qf</code> will be aggregated. Intensities are assumed to already be log-transformed.</p></dd>


<dt id="arg-includesharedpeptides">includeSharedPeptides<a class="anchor" aria-label="anchor" href="#arg-includesharedpeptides"></a></dt>
<dd><p>How shared peptides are handled. Either <code>Yes_As_Specific</code> (default), <code>Yes_Iterative_Redistribution</code>, <code>Yes_Simple_Redistribution</code> or <code>No</code>.
See below for details.</p></dd>


<dt id="arg-operator">operator<a class="anchor" aria-label="anchor" href="#arg-operator"></a></dt>
<dd><p>A function used for quantitative feature aggregation.
Available functions are <code>Sum</code>, <code>Mean</code>, <code>Median</code>, <code>medianPolish</code> or <code>robustSummary</code>.
See below for details.</p></dd>


<dt id="arg-considerpeptides">considerPeptides<a class="anchor" aria-label="anchor" href="#arg-considerpeptides"></a></dt>
<dd><p>A <code>character(1)</code> defining what peptide to consider. Available values are <code>allPeptides</code> (default) and <code>topN</code>.</p></dd>


<dt id="arg-adjmatrix">adjMatrix<a class="anchor" aria-label="anchor" href="#arg-adjmatrix"></a></dt>
<dd><p>A <code>character(1)</code> naming a rowdata variable from the last assay of <code>qf</code> containing an adjacency matrix.</p></dd>


<dt id="arg-ponderation">ponderation<a class="anchor" aria-label="anchor" href="#arg-ponderation"></a></dt>
<dd><p>A <code>character(1)</code> defining what to consider to create the coefficient for redistribution of shared peptides.
Available values are <code>Global</code> (default), <code>Condition</code> or <code>Sample</code>.</p></dd>


<dt id="arg-n">n<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>If <code>topN</code>, specify the number of peptides to use for each protein.</p></dd>


<dt id="arg-aggregated-col">aggregated_col<a class="anchor" aria-label="anchor" href="#arg-aggregated-col"></a></dt>
<dd><p>A <code><a href="https://rdrr.io/r/base/character.html" class="external-link">character()</a></code> of column names from rowdata to be aggregated.</p></dd>


<dt id="arg-max-iter">max_iter<a class="anchor" aria-label="anchor" href="#arg-max-iter"></a></dt>
<dd><p>A <code>numeric(1)</code> setting the maximum number of iteration.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A <a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">QFeatures</a> with an aggregated assay added.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Aggregation of quantitative data is performed using <a href="https://rdrr.io/pkg/ProtGenerics/man/protgenerics.html" class="external-link">aggregateFeatures</a>, or <a href="inner.aggregate.iter.html">inner.aggregate.iter</a> if <code>Yes_Iterative_Redistribution</code> or <code>Yes_Simple_Redistribution</code> is selected.</p>
<p>The handling of shared peptide is as follow :</p><ul><li><p><code>Yes_As_Specific</code> : Shared peptides are used multiple times.
Each peptide is duplicated as many times as the number of proteins in which they are present, and thus are considered as if they are specific to each protein.</p></li>
<li><p><code>Yes_Simple_Redistribution</code> : Intensity of shared peptides are redistributed proportionally to each protein. See <a href="inner.aggregate.iter.html">inner.aggregate.iter</a> for more information.</p></li>
<li><p><code>Yes_Iterative_Redistribution</code> : Intensity of shared peptides are redistributed proportionally to each protein. See <a href="inner.aggregate.iter.html">inner.aggregate.iter</a> for more information.</p></li>
<li><p><code>No</code> : No shared peptides are used. If a peptide contained only shared peptides, its intensity is set as 0 for every sample.</p></li>
</ul><p>Available functions are :</p><ul><li><p><code>Sum</code> : <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colSums()</a></code> or <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::rowSums()</a></code> if <code>Yes_Iterative_Redistribution</code> or <code>Yes_Simple_Redistribution</code>.</p></li>
<li><p><code>Mean</code> : <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::colMeans()</a></code> or <code><a href="https://rdrr.io/r/base/colSums.html" class="external-link">base::rowMeans()</a></code> if <code>Yes_Iterative_Redistribution</code> or <code>Yes_Simple_Redistribution</code>.</p></li>
<li><p><code>Median</code> : <code><a href="https://rdrr.io/pkg/matrixStats/man/rowMedians.html" class="external-link">matrixStats::colMedians()</a></code> or <code><a href="https://rdrr.io/pkg/matrixStats/man/rowMedians.html" class="external-link">matrixStats::rowMedians()</a></code> if <code>Yes_Iterative_Redistribution</code> or <code>Yes_Simple_Redistribution</code>.</p></li>
<li><p><code>medianPolish</code> : <code><a href="https://rdrr.io/pkg/MsCoreUtils/man/medianPolish.html" class="external-link">MsCoreUtils::medianPolish()</a></code>.</p></li>
<li><p><code>robustSummary</code> : <code><a href="https://rdrr.io/pkg/MsCoreUtils/man/robustSummary.html" class="external-link">MsCoreUtils::robustSummary()</a></code>.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Samuel Wieczorek, Manon Gaudin</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span> <span class="co"># \dontrun{</span></span></span>
<span class="r-in"><span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Exp1_R25_pept</span>, package<span class="op">=</span><span class="st">"DaparToolshedData"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">ft</span> <span class="op">&lt;-</span> <span class="va">Exp1_R25_pept</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">]</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_As_Specific"</span>, <span class="st">"Sum"</span>, <span class="st">"allPeptides"</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_As_Specific"</span>, <span class="st">"Mean"</span>, <span class="st">"allPeptides"</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_As_Specific"</span>, <span class="st">"Sum"</span>, <span class="st">"topN"</span>, n <span class="op">=</span> <span class="fl">4</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_As_Specific"</span>, <span class="st">"Mean"</span>, <span class="st">"topN"</span>, n <span class="op">=</span> <span class="fl">4</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"No"</span>, <span class="st">"Sum"</span>, <span class="st">"allPeptides"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"No"</span>, <span class="st">"Sum"</span>, <span class="st">"topN"</span>, n <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_Redistribution"</span>, <span class="st">"Sum"</span>, <span class="st">"allPeptides"</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">obj.agg</span> <span class="op">&lt;-</span> <span class="fu">RunAggregation</span><span class="op">(</span><span class="va">ft</span>, <span class="st">"Yes_Redistribution"</span>, <span class="st">"Sum"</span>, <span class="st">"topN"</span>, n <span class="op">=</span> <span class="fl">4</span>, aggregated_col <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">SummarizedExperiment</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/SummarizedExperiment/man/SummarizedExperiment-class.html" class="external-link">rowData</a></span><span class="op">(</span><span class="va">ft</span><span class="op">[[</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">ft</span><span class="op">)</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span> <span class="co"># }</span></span></span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

