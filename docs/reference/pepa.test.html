<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>PEptide based Protein differential Abundance test — pepa.test • DaparToolshed</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="PEptide based Protein differential Abundance test — pepa.test"><meta name="description" content="PEptide based Protein differential Abundance test"><meta property="og:description" content="PEptide based Protein differential Abundance test"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">DaparToolshed</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.99.8</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/edyp-lab/DaparToolshed/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>PEptide based Protein differential Abundance test</h1>
      <small class="dont-index">Source: <a href="https://github.com/edyp-lab/DaparToolshed/blob/HEAD/R/pepa.R" class="external-link"><code>R/pepa.R</code></a></small>
      <div class="d-none name"><code>pepa.test.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>PEptide based Protein differential Abundance test</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">pepa.test</span><span class="op">(</span><span class="va">X</span>, <span class="va">y</span>, <span class="va">n1</span>, <span class="va">n2</span>, global <span class="op">=</span> <span class="cn">FALSE</span>, use.lm <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-x">X<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Binary q x p design matrix for q peptides and p
proteins. X_(ij)=1 if peptide i belongs to protein j, 0 otherwise.</p></dd>


<dt id="arg-y">y<a class="anchor" aria-label="anchor" href="#arg-y"></a></dt>
<dd><p>q x n matrix representing the log intensities of q peptides
among n MS samples.</p></dd>


<dt id="arg-n-">n1<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>number of samples under condition 1. It is assumed that the first
n1 columns of y correspond to observations under condition 1.</p></dd>


<dt id="arg-n-">n2<a class="anchor" aria-label="anchor" href="#arg-n-"></a></dt>
<dd><p>number of samples under condition 2.</p></dd>


<dt id="arg-global">global<a class="anchor" aria-label="anchor" href="#arg-global"></a></dt>
<dd><p>if TRUE, the test statistic for each protein uses all
residues, including the ones for peptides in different connected
components. Can be much faster as it does not require to compute
connected components. However the p-values are not well calibrated
in this case, as it amounts to adding a ridge to the test
statistic. Calibrating the p-value would require knowing the
amplitude of the ridge, which in turns would require computing the
connected components.</p></dd>


<dt id="arg-use-lm">use.lm<a class="anchor" aria-label="anchor" href="#arg-use-lm"></a></dt>
<dd><p>if TRUE (and if global=FALSE), use lm() rather than the result
in Proposition 1 to compute the test statistic</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A list of the following elements:
llr: log likelihood ratio statistic (maximum likelihood version).
llr.map: log likelihood ratio statistic (maximum a posteriori version).
llr.pv: p-value for llr.
llr.map.pv: p-value for llr.map.
mse.h0: Mean squared error under H0
mse.h1: Mean squared error under H1
s: selected regularization hyperparameter for llr.map.
wchi2: weight used to make llr.map chi2-distributed under H0.</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Thomas Burger, Laurent Jacob</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="cn">NA</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] NA</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

