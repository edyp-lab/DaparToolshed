<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Plots a histogram of p-values — diff_analysis_sam,SummarizedExperiment-method • DaparToolshed</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Plots a histogram of p-values — diff_analysis_sam,SummarizedExperiment-method"><meta property="og:description" content="This function is a wrappper to the function adjust.p from the cp4p package. It returns the FDR corresponding to the p-values of the
differential analysis. The FDR is computed with the function p.adjust{stats}..
This method returns a list of the statistical tests performed with xxx and formatted as a
list of two DataFrame: one for the logFC data and one for the p-values data.
This method returns a class QFeatures object with the results
of differential analysis
Plots an interactive volcanoplot after the differential analysis.
Typically, the log of Fold Change is represented on the X-axis and the
log10 of the p-value is drawn on the Y-axis. When the threshold_pVal
and the threshold_logFC are set, two lines are drawn respectively on
the y-axis and the X-axis to visually distinguish between differential and
non differential data. With the use of the package Highcharter, a
customizable tooltip appears when the user put the mouse's pointer over
a point of the scatter plot."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">DaparToolshed</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.99.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/samWieczorek/DaparToolshed/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plots a histogram of p-values</h1>
    <small class="dont-index">Source: <a href="https://github.com/samWieczorek/DaparToolshed/blob/HEAD/R/DiffAnalysis.R" class="external-link"><code>R/DiffAnalysis.R</code></a>, <a href="https://github.com/samWieczorek/DaparToolshed/blob/HEAD/R/plots_volcano.R" class="external-link"><code>R/plots_volcano.R</code></a></small>
    <div class="hidden name"><code>differential-analysis.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>This function is a wrappper to the function adjust.p from the cp4p package. It returns the FDR corresponding to the p-values of the
differential analysis. The FDR is computed with the function <code>p.adjust</code>{stats}..</p>
<p>This method returns a list of the statistical tests performed with xxx and formatted as a
list of two DataFrame: one for the logFC data and one for the p-values data.</p>
<p>This method returns a class <code>QFeatures</code> object with the results
of differential analysis</p>
<p>Plots an interactive volcanoplot after the differential analysis.
Typically, the log of Fold Change is represented on the X-axis and the
log10 of the p-value is drawn on the Y-axis. When the <code>threshold_pVal</code>
and the <code>threshold_logFC</code> are set, two lines are drawn respectively on
the y-axis and the X-axis to visually distinguish between differential and
non differential data. With the use of the package Highcharter, a
customizable tooltip appears when the user put the mouse's pointer over
a point of the scatter plot.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="co"># S4 method for SummarizedExperiment</span>
<span class="fu"><a href="diff_analysis_sam.html">diff_analysis_sam</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">...</span><span class="op">)</span>

<span class="co"># S4 method for QFeatures</span>
<span class="fu"><a href="diff_analysis_sam.html">diff_analysis_sam</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">i</span>, name <span class="op">=</span> <span class="st">"diffAnaAssay"</span>, <span class="va">...</span><span class="op">)</span>

<span class="fu">histPValue_HC</span><span class="op">(</span><span class="va">pval_ll</span>, bins <span class="op">=</span> <span class="fl">80</span>, pi0 <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>

<span class="fu">diffAnaComputeFDR</span><span class="op">(</span>
  <span class="va">logFC</span>,
  <span class="va">pval</span>,
  threshold_PVal <span class="op">=</span> <span class="fl">0</span>,
  threshold_LogFC <span class="op">=</span> <span class="fl">0</span>,
  pi0Method <span class="op">=</span> <span class="fl">1</span>
<span class="op">)</span>

<span class="fu">Get_AllComparisons</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>

<span class="fu">diffAnalysis</span><span class="op">(</span><span class="va">obj</span>, <span class="va">comp</span>, th_pval <span class="op">=</span> <span class="fl">0</span>, th_logFC <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>

<span class="fu">diffAnaVolcanoplot_rCharts</span><span class="op">(</span>
  <span class="va">df</span>,
  threshold_pVal <span class="op">=</span> <span class="fl">1e-60</span>,
  threshold_logFC <span class="op">=</span> <span class="fl">0</span>,
  conditions <span class="op">=</span> <span class="cn">NULL</span>,
  clickFunction <span class="op">=</span> <span class="cn">NULL</span>,
  palette <span class="op">=</span> <span class="cn">NULL</span>,
  swap <span class="op">=</span> <span class="cn">FALSE</span>
<span class="op">)</span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>object</dt>
<dd><p>An object of class <code>QFeatures</code> or <code>SummarizedExperiment</code>.</p></dd>
<dt>...</dt>
<dd><p>Additional parameters passed to inner functions.</p></dd>
<dt>i</dt>
<dd><p>A numeric vector or a character vector giving the index or the
name, respectively, of the assay(s) to be processed.</p></dd>
<dt>name</dt>
<dd><p>A <code>character(1)</code> naming the new assay name. Default is <code>ttestAssay</code>.</p></dd>
<dt>pval_ll</dt>
<dd><p>A data frame which contains the p-values for the set of comparisons to show.</p></dd>
<dt>bins</dt>
<dd><p>xxx</p></dd>
<dt>pi0</dt>
<dd><p>xxx</p></dd>
<dt>logFC</dt>
<dd><p>The result (logFC values) of the differential analysis processed
by 'limmaCompleteTest'</p></dd>
<dt>pval</dt>
<dd><p>The result (p-values) of the differential analysis processed
by 'limmaCompleteTest'</p></dd>
<dt>threshold_PVal</dt>
<dd><p>The threshold on p-pvalue to
distinguish between differential and non-differential data</p></dd>
<dt>threshold_LogFC</dt>
<dd><p>The threshold on log(Fold Change) to
distinguish between differential and non-differential data</p></dd>
<dt>pi0Method</dt>
<dd><p>The parameter pi0.method of the method adjust.p
in the package <code>cp4p</code></p></dd>
<dt>obj</dt>
<dd><p>An object of class <code>SUmmarizeExperiment</code>.</p></dd>
<dt>comp</dt>
<dd><p>The name of the comparison (given by the t-tests) on whihc to apply thresholds</p></dd>
<dt>th_pval</dt>
<dd><p>xxx</p></dd>
<dt>th_logFC</dt>
<dd><p>xxx</p></dd>
<dt>df</dt>
<dd><p>A dataframe which contains the following slots :
x : a vector of the log(fold change) values of the differential analysis,
y : a vector of the p-value values returned by the differential analysis.
index : a vector of the rownames of the data.
This dataframe must has been built with the option stringsAsFactors set
to FALSE. There may be additional slots which will be used to show
informations in the tooltip. The name of these slots must begin with the
prefix "tooltip_". It will be automatically removed in the plot.</p></dd>
<dt>threshold_pVal</dt>
<dd><p>A floating number which represents the p-value that
separates differential and non-differential data.</p></dd>
<dt>threshold_logFC</dt>
<dd><p>A floating number which represents the log of the
Fold Change that separates differential and non-differential data.</p></dd>
<dt>conditions</dt>
<dd><p>A list of the names of condition 1 and 2 used for the
differential analysis.</p></dd>
<dt>clickFunction</dt>
<dd><p>A string that contains a JavaScript function used to
show info from slots in df. The variable this.index refers to the slot
named index and allows to retrieve the right row to show in the tooltip.</p></dd>
<dt>palette</dt>
<dd><p>xxx</p></dd>
<dt>swap</dt>
<dd><p>A boolean that indicates if the conditions have been swaped</p></dd>
</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>A plot
The computed FDR value (floating number)
A list of two slots: logFC and P_Value. Each slot contains a DataFrame
An object of class <code>SummarizedExperiment</code>An interactive volcanoplot</p>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Samuel Wieczorek</p>
<p>Samuel Wieczorek</p>
<p>Samuel Wieczorek</p>
<p>Samuel Wieczorek</p>
<p>Samuel Wieczorek, Enora Fremy</p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">Exp1_R25_pept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">'Exp1_R25_pept.rda'</span>, package<span class="op">=</span><span class="st">"DaparToolshedData"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open compressed file '', probable reason 'Invalid argument'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in gzfile(file, "rb"):</span> cannot open the connection</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">Exp1_R25_pept</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'Exp1_R25_pept' not found</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">object</span>, <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  pNA <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, name<span class="op">=</span><span class="st">'filtered'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'object' not found</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu">addListAdjacencyMatrices</span><span class="op">(</span><span class="va">object</span>, <span class="fl">3</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in addListAdjacencyMatrices(object, 3):</span> could not find function "addListAdjacencyMatrices"</span>
<span class="r-in"><span class="va">sTab</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colData': object 'object' not found</span>
<span class="r-in"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">t_test_sam</span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">sTab</span>, FUN <span class="op">=</span> <span class="va">compute.t.test</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in t_test_sam(object[[3]], sTab, FUN = compute.t.test):</span> could not find function "t_test_sam"</span>
<span class="r-in"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">[[</span><span class="st">'25fmol_vs_10fmol_pval'</span><span class="op">]</span><span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'se' not found</span>
<span class="r-in"><span class="fu">histPValue_HC</span><span class="op">(</span><span class="va">pval</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'sort': object 'pval' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">Exp1_R25_pept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">'Exp1_R25_pept.rda'</span>, package<span class="op">=</span><span class="st">"DaparToolshedData"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open compressed file '', probable reason 'Invalid argument'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in gzfile(file, "rb"):</span> cannot open the connection</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="va">Exp1_R25_pept</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'Exp1_R25_pept' not found</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">obj</span>, <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  pNA <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, name<span class="op">=</span><span class="st">'filtered'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'obj' not found</span>
<span class="r-in"><span class="va">se</span> <span class="op">&lt;-</span> <span class="fu">t_test_sam</span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="va">compute.t.test</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in t_test_sam(obj[[3]], colData(obj), FUN = compute.t.test):</span> could not find function "t_test_sam"</span>
<span class="r-in"><span class="va">ind_logFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">'_logFC'</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'grep': error in evaluating the argument 'x' in selecting a method for function 'colnames': error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'se' not found</span>
<span class="r-in"><span class="va">logFC</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">[</span>,<span class="va">ind_logFC</span><span class="op">]</span><span class="op">)</span>, </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">)</span><span class="op">[</span><span class="va">ind_logFC</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colnames': error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'se' not found</span>
<span class="r-in"><span class="va">ind_pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">grep</a></span><span class="op">(</span><span class="st">'_pval'</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'grep': error in evaluating the argument 'x' in selecting a method for function 'colnames': error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'se' not found</span>
<span class="r-in"><span class="va">pval</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/setNames.html" class="external-link">setNames</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">[</span>,<span class="va">ind_pval</span><span class="op">]</span><span class="op">)</span>, </span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="fu">metadata</span><span class="op">(</span><span class="va">se</span><span class="op">)</span><span class="op">$</span><span class="va">t_test</span><span class="op">)</span><span class="op">[</span><span class="va">ind_pval</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colnames': error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'se' not found</span>
<span class="r-in"><span class="fu">diffAnaComputeFDR</span><span class="op">(</span><span class="va">logFC</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, <span class="va">pval</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in which(abs(logFC) &gt;= threshold_LogFC):</span> object 'logFC' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">Exp1_R25_pept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">'Exp1_R25_pept.rda'</span>, package<span class="op">=</span><span class="st">"DaparToolshedData"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open compressed file '', probable reason 'Invalid argument'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in gzfile(file, "rb"):</span> cannot open the connection</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="va">Exp1_R25_pept</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span>,<span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'Exp1_R25_pept' not found</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">object</span>, <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  pNA <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, name<span class="op">=</span><span class="st">'filtered'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'object' not found</span>
<span class="r-in"><span class="va">sTab</span> <span class="op">&lt;-</span> <span class="fu">colData</span><span class="op">(</span><span class="va">object</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'colData': object 'object' not found</span>
<span class="r-in"><span class="va">gttest.se</span> <span class="op">&lt;-</span> <span class="fu">t_test_sam</span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="va">sTab</span>, FUN <span class="op">=</span> <span class="va">compute.t.test</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in t_test_sam(object[[3]], sTab, FUN = compute.t.test):</span> could not find function "t_test_sam"</span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">object</span>, <span class="va">gttest.se</span>, name<span class="op">=</span><span class="st">'t-test'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'object' not found</span>
<span class="r-in"><span class="va">comp</span> <span class="op">&lt;-</span> <span class="st">'25fmol_vs_10fmol'</span></span>
<span class="r-in"><span class="va">object</span> <span class="op">&lt;-</span> <span class="fu"><a href="diff_analysis_sam.html">diff_analysis_sam</a></span><span class="op">(</span><span class="va">object</span>, <span class="st">'t-test'</span>, name<span class="op">=</span><span class="st">'diffAna'</span>, <span class="va">comp</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'diff_analysis_sam': object 'object' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="va">allComp</span> <span class="op">&lt;-</span> <span class="fu">Get_AllComparisons</span><span class="op">(</span><span class="va">object</span><span class="op">[[</span><span class="st">'diffAna'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'metadata': object 'object' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="va">Exp1_R25_pept</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/readRDS.html" class="external-link">readRDS</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"data"</span>, <span class="st">'Exp1_R25_pept.rda'</span>, package<span class="op">=</span><span class="st">"DaparToolshedData"</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open compressed file '', probable reason 'Invalid argument'</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in gzfile(file, "rb"):</span> cannot open the connection</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="va">Exp1_R25_pept</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq_len</a></span><span class="op">(</span><span class="fl">1000</span><span class="op">)</span><span class="op">]</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in eval(expr, envir, enclos):</span> object 'Exp1_R25_pept' not found</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">obj</span>, <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>,  pNA <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>, name<span class="op">=</span><span class="st">'filtered'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'obj' not found</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-class.html" class="external-link">addAssay</a></span><span class="op">(</span><span class="va">obj</span>, <span class="fu">t_test_sam</span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>, <span class="fu">colData</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span>, FUN <span class="op">=</span> <span class="st">'compute.t.test'</span><span class="op">)</span>, name<span class="op">=</span><span class="st">'t-test'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in stopifnot(inherits(x, "QFeatures")):</span> object 'obj' not found</span>
<span class="r-in"><span class="va">comp</span> <span class="op">&lt;-</span> <span class="st">'25fmol_vs_10fmol'</span></span>
<span class="r-in"><span class="va">da.se</span> <span class="op">&lt;-</span> <span class="fu">diffAnalysis</span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="st">'t-test'</span><span class="op">]</span><span class="op">]</span>, <span class="va">comp</span>, th_pval<span class="op">=</span><span class="fl">0</span>, th_logFC<span class="op">=</span><span class="fl">0</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in diffAnalysis(obj[["t-test"]], comp, th_pval = 0, th_logFC = 0):</span> object 'obj' not found</span>
<span class="r-in"></span>
<span class="r-in"><span class="co"># \donttest{</span></span>
<span class="r-in"><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/RforMassSpectrometry/QFeatures" class="external-link">QFeatures</a></span><span class="op">)</span></span>
<span class="r-in"><span class="fu">utils</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/r/utils/data.html" class="external-link">data</a></span><span class="op">(</span><span class="va">Exp1_R25_pept</span>, package<span class="op">=</span><span class="st">'DaparToolshedData'</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in find.package(package, lib.loc, verbose = verbose):</span> there is no package called 'DaparToolshedData'</span>
<span class="r-in"><span class="va">obj</span> <span class="op">&lt;-</span> <span class="fu">QFeatures</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/QFeatures/man/QFeatures-missing-data.html" class="external-link">filterNA</a></span><span class="op">(</span><span class="va">Exp1_R25_pept</span>,i<span class="op">=</span><span class="st">'original'</span><span class="op">)</span> <span class="co"># remove all rows with NAs</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'object' in selecting a method for function 'filterNA': object 'Exp1_R25_pept' not found</span>
<span class="r-in"><span class="va">qData</span> <span class="op">&lt;-</span> <span class="fu">assay</span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'assay': object 'obj' not found</span>
<span class="r-in"><span class="va">pData</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'as.data.frame': error in evaluating the argument 'x' in selecting a method for function 'colData': object 'obj' not found</span>
<span class="r-in"><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu">limma.complete.test</span><span class="op">(</span><span class="va">qData</span>,<span class="va">pData</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in limma.complete.test(qData, pData):</span> could not find function "limma.complete.test"</span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">data</span><span class="op">[</span>,<span class="fl">1</span><span class="op">]</span>, y <span class="op">=</span> <span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html" class="external-link">log10</a></span><span class="op">(</span><span class="va">data</span><span class="op">[</span>,<span class="fl">2</span><span class="op">]</span><span class="op">)</span>,index <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html" class="external-link">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">rownames</a></span><span class="op">(</span><span class="va">qData</span><span class="op">)</span><span class="op">)</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in data[, 1]:</span> object of type 'closure' is not subsettable</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"x"</span>, <span class="st">"y"</span>, <span class="st">"index"</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `colnames&lt;-`(`*tmp*`, value = c("x", "y", "index")):</span> attempt to set 'colnames' on an object with less than two dimensions</span>
<span class="r-in"><span class="va">tooltipSlot</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Sequence"</span>, <span class="st">"Score"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">df</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">df</span>,<span class="fu">rowData</span><span class="op">(</span><span class="va">obj</span><span class="op">[[</span><span class="st">'original'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">[</span><span class="va">tooltipSlot</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'rowData': object 'obj' not found</span>
<span class="r-in"><span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html" class="external-link">gsub</a></span><span class="op">(</span><span class="st">"."</span>, <span class="st">"_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span>, fixed<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in `colnames&lt;-`(`*tmp*`, value = character(0)):</span> attempt to set 'colnames' on an object with less than two dimensions</span>
<span class="r-in"><span class="kw">if</span> <span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span><span class="op">{</span></span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span> <span class="op">&lt;-</span> </span>
<span class="r-in">    <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"tooltip_"</span>, <span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">[</span><span class="fl">4</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html" class="external-link">ncol</a></span><span class="op">(</span><span class="va">df</span><span class="op">)</span><span class="op">]</span>, sep<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">}</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in if (ncol(df) &gt; 3) {    colnames(df)[4:ncol(df)] &lt;- paste("tooltip_", colnames(df)[4:ncol(df)],         sep = "")}:</span> argument is of length zero</span>
<span class="r-in"><span class="va">hc_clickFunction</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://jkunst.com/highcharter/reference/highcharter-exports.html" class="external-link">JS</a></span><span class="op">(</span><span class="st">"function(event) {</span>
<span class="r-in">Shiny.onInputChange('eventPointClicked', [this.index]+'_'+ [this.series.name]);}"</span><span class="op">)</span></span>
<span class="r-in"><span class="va">cond</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/unique.html" class="external-link">unique</a></span><span class="op">(</span><span class="fu">colData</span><span class="op">(</span><span class="va">obj</span><span class="op">)</span><span class="op">[[</span><span class="st">'Condition'</span><span class="op">]</span><span class="op">]</span><span class="op">)</span></span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in h(simpleError(msg, call)):</span> error in evaluating the argument 'x' in selecting a method for function 'unique': error in evaluating the argument 'x' in selecting a method for function 'colData': object 'obj' not found</span>
<span class="r-in"><span class="fu">diffAnaVolcanoplot_rCharts</span><span class="op">(</span><span class="va">df</span>, <span class="fl">2.5</span>, <span class="fl">1</span>, <span class="va">cond</span>, <span class="va">hc_clickFunction</span><span class="op">)</span> </span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in paste("log2 ( mean(", conditions[2], ") / mean(", conditions[1],     ") )", sep = ""):</span> object 'cond' not found</span>
<span class="r-in"><span class="co"># }</span></span>
<span class="r-in"></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Samuel Wieczorek, Thomas Burger.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.2.</p>
</div>

      </footer></div>

  


  

  </body></html>

